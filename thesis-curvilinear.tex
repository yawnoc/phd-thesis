\chapter{Boundary tracing in curvilinear coordinates}

The actual determination of the sought-after traced boundaries involves
recasting the flux boundary condition~(\ref{eq:flux-boundary-condition})
as an ODE (or system of ODEs) for the traced boundaries.
In practice, the appropriate coordinate system and parametrisation
will depend on the geometry of the specific problem at hand.
In preparation for the various coordinate systems
which will be used in this thesis,
I derive in this chapter the boundary tracing ODE
in an orthogonal curvilinear coordinate system,
along with the corresponding system of ODEs
under arc-length parametrisation.

\section{Orthogonal curvilinear coordinates in 2D}

Let~$(\basisvec{x}, \basisvec{y})$ be the standard basis vectors
of the usual Cartesian coordinates~$(x, y)$.
The \emph{position vector} is
\begin{equation}
  \vec{r} = x \basisvec{x} + y \basisvec{y},
  \label{eq:position-vector-cartesian}
\end{equation}
and since $\basisvec{x}$ and~$\basisvec{y}$ are globally constant,
observe that
\begin{align}
  \basisvec{x} &= \pder{\vec{r}}{x},
    \label{eq:x-basis-vector} \\[\fraclinespace]
  \basisvec{y} &= \pder{\vec{r}}{y}.
    \label{eq:y-basis-vector}
\end{align}
Now consider the \emph{curvilinear coordinates}~$(u, v)$
given by the transformation
\begin{align}
  x &= x (u, v), \label{eq:curvilinear-x-transformation} \\
  y &= y (u, v). \label{eq:curvilinear-y-transformation}
\end{align}
A \emph{local basis}~$(\localvec{u}, \localvec{v})$
arises from the derivatives of position
in analogy to~(\ref{eq:x-basis-vector}) and~(\ref{eq:y-basis-vector}),
\begin{align}
  \localvec{u} &
    = \pder{\vec{r}}{u}
    = \pder{x}{u} \basisvec{x} + \pder{y}{u} \basisvec{y},
      \label{eq:u-local-basis-vector} \\[\fraclinespace]
  \localvec{v} &
    = \pder{\vec{r}}{v}
    = \pder{x}{v} \basisvec{x} + \pder{y}{v} \basisvec{y}.
      \label{eq:v-local-basis-vector}
\end{align}
