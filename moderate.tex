\chapter{Moderate convex wedges}
\label{ch:moderate}

In this chapter
we apply numerical boundary tracing to analyse corner rounding
in a moderate convex capillary wedge.
We include the borderline with the small-wedge regime
so that the full interval under consideration
is~$\pi/2 - \gamma \le \alpha < \pi/2$,
where $\alpha$~is the wedge half-angle
and $\gamma$~is the contact angle.
Specifically, we take a numerical solution
to the Laplace--Young equation~(\ref{eq:laplace-young}) in such a wedge
and seek rounded corners along which
the contact condition~(\ref{eq:contact-boundary-condition})
remains satisfied.

At this point an objection will rightfully be raised:
Given that a numerical solver is needed
to generate the numerical wedge solution in the first place,
why bother with boundary tracing at all?
Indeed if boundary tracing can only produce
one corner rounding per numerical wedge solution,
why not directly apply the numerical solver to a rounded wedge?
This objection is addressed
in Section~\ref{sec:moderate.multiple},
where a novel observation is made
which enables multiple corner roundings to be produced by boundary tracing
per numerical wedge solution.

\thematicbreak

For simplicity we take the wedge to be of infinite extent.
The only physical parameter which appears
in the Laplace--Young equation~(\ref{eq:laplace-young})
and in the boundary condition~(\ref{eq:contact-boundary-condition})
is the capillary constant~$\capill$,
which has the dimensions of reciprocal area;
thus the sole length scale of the problem
is the capillary length
\begin{equation}
  L_0 = \frac{1}{\sqrt{\kappa}}.
  \label{eq:capillary-length}
\end{equation}
We therefore put
\begin{align}
  T &\ideq L_0 \scaled{T}, \label{eq:capillary-height-scaling} \\
  x &\ideq L_0 \scaled{x}, \label{eq:capillary-x-scaling} \\
  y &\ideq L_0 \scaled{y}, \label{eq:capillary-y-scaling}
\end{align}
noting that the derivative will transform according to
\begin{equation}
  \del \ideq \scaleddel / L_0.
  \label{eq:capillary-del-scaling}
\end{equation}
Substituting and dropping \scalingmarks,
we obtain the dimensionless Laplace--Young equation
\begin{equation}
  \del \dotp \frac{\del T}{\sqrt{1 + (\del T)^2}} =  T
  \label{eq:scaled-laplace-young}
\end{equation}
within the scaled wedge,
whilst on the boundary we obtain the dimensionless contact condition
\begin{equation}
  \normalvec \dotp \frac{\del T}{\sqrt{1 + (\del T)^2}} = \cos\gamma.
  \label{eq:scaled-contact-boundary-condition}
\end{equation}

\section{Linearised corner rounding revisited}
\label{sec:moderate.linearised}

In this section we revisit the linearised corner rounding problem
for a right-angled wedge
considered by Anderson~\etal~%
  \cite{anderson-2007-boundary-tracing-ii-applications}.
We do so here to provide ourselves
with an explicit example of corner rounding (via boundary tracing)
in which the wedge solution is known analytically,
\emph{before} proceeding to the fully nonlinear case
where the known wedge solution will be a numerical one.

A similar revisit appeared in Section~2.1 of
the author's Honours thesis~\cite{li-2017-thesis-rounding-capillary-wedge};
there the analysis was conducted purely in polar coordinates,
rather than in the Cartesian coordinates and arc-length parametrisation
used here.

\subsection{Known solution}
\label{sec:moderate.linearised.known}

In the problem under consideration
the wedge is convex and right-angled, i.e.~$\alpha = \pi/4$,
with the contact~$\gamma$ assumed to be close to~$\pi/2$,
so that the capillary problem~(\ref{eq:scaled-laplace-young})
\&~(\ref{eq:scaled-contact-boundary-condition})
may be linearised by discarding~$(\del T)^2 \ll 1$.
The subsidiary height scaling
\begin{equation}
  T \ideq U \cos\gamma
  \label{eq:helmholtz-height-scaling}
\end{equation}
removes the contact angle parameter,
leaving us with a linear BVP consisting of
the Helmholtz equation
\begin{equation}
  \del^2 U = U
  \label{eq:scaled-helmholtz}
\end{equation}
in the interior
together with the constant-flux condition
\begin{important}{equation}
  \normalvec \dotp \del U = 1
  \label{eq:scaled-contact-linearised}
\end{important}
on the boundary.

Whereas Anderson~\etal~\cite{anderson-2007-boundary-tracing-ii-applications}
used Cartesian coordinates aligned with the wedge walls,
here we align the positive $x$-axis so that it bisects the wedge
(for a logical extension to arbitrary wedge angles).
Thus the domain is the region~$\abs{y} < x$,
while the boundary consists of the wedge walls~$y = \pm x$ (with~$x \ge 0$),
as shown in Figure~X. % TODO

As observed by Fowkes \&~Hood~\cite[equation~(16)]{
  fowkes-1998-surface-tension-effects-wedge
},
the known solution to the Helmholtz BVP in this wedge is given by
\begin{important}{equation}
  U \ideq \exp \frac{-x+y}{\sqrt{2}} + \exp \frac{-x-y}{\sqrt{2}},
  \label{eq:scaled-helmholtz-solution}
\end{important}
a superposition of capillary layers contributed by each wall.

\subsection{Boundary tracing}
\label{sec:moderate.linearised.tracing}

Comparing the flux condition~(\ref{eq:scaled-contact-linearised})
to the generic one~(\ref{eq:flux-boundary-condition})
(and noting that here we have~$U$ in place of~$T$),
we see that the flux function is simply
\begin{equation}
  F \ideq 1.
  \label{eq:helmholtz-flux-function}
\end{equation}
The derivatives of the known solution are
\begin{align}
  P &\ideq \pder{U}{x} \ideq
    \frac{1}{\sqrt{2}} \roundbr*{
      - \exp \frac{-x+y}{\sqrt{2}} - \exp \frac{-x-y}{\sqrt{2}}
    },
    \label{eq:helmholtz-gradient-x-component} \\[\tallspace]
  Q &\ideq \pder{U}{y} \ideq
    \frac{1}{\sqrt{2}} \roundbr*{
      + \exp \frac{-x+y}{\sqrt{2}} - \exp \frac{-x-y}{\sqrt{2}}
    },
    \label{eq:helmholtz-gradient-y-component}
\end{align}
and so the viability function is
\begin{align*}
  \Phi
  &\ideq (\del U)^2 - F^2 \\
  &\ideq \ee^{-\sqrt{2} (x - y)} + \ee^{-\sqrt{2} (x + y)} - 1.
    \yesnumber
    \label{eq:helmholtz-viability-function}
\end{align*}
Traced boundaries will only exist in the viable domain~$\Phi \ge 0$,
which may be written explicitly as
\begin{equation}
  x \le
    \frac{1}{\sqrt{2}}
    \log \roundbr*{2 \cosh \roundbr[\bulkysize]{\sqrt{2} \cdot y}}.
    \label{eq:helmholtz-viable-domain}
\end{equation}
Its border, the terminal curve~$\Phi = 0$,
is therefore given by
\begin{equation}
  x =
    \frac{1}{\sqrt{2}}
    \log \roundbr*{2 \cosh \roundbr[\bulkysize]{\sqrt{2} \cdot y}},
    \label{eq:helmholtz-terminal-curve}
\end{equation}
with the non-viable domain~$\Phi < 0$ lying strictly to its right
(Figure~X). % TODO
Note how the terminal curve approaches the wedge walls~$y = \pm x$
as one moves away from the line of symmetry~$y = 0$.

The known solution~(\ref{eq:scaled-helmholtz-solution})
is insufficiently simple in form
for the boundary tracing ODE to be analytically solvable
under the coordinate parametrisations~$y = y (x)$ and~$x = x (y)$.
We therefore use the system~(\ref{eq:tracing-ode-arc-length-parametrisation-u})
\&~(\ref{eq:tracing-ode-arc-length-parametrisation-v})
for arc-length parametrisation,
which in the present case reduces to
\begin{important}{align}
  \tder{x}{s} &= \frac{-Q \pm P \sqrt{\Phi}}{(\del U)^2},
    \label{eq:helmholtz-tracing-ode-arc-length-parametrisation-x}
    \\[\tallspace]
  \tder{y}{s} &= \frac{+P \pm Q \sqrt{\Phi}}{(\del U)^2}.
    \label{eq:helmholtz-tracing-ode-arc-length-parametrisation-y}
\end{important}
Figure~X % TODO
shows the two branches of traced boundaries obtained
by integrating forward from various points
within the viable domain~(\ref{eq:helmholtz-viable-domain}).
The upper and lower branches have positive and negative slopes respectively.
As expected,
boundary tracing recovers the original boundaries of the Helmholtz BVP\@;
indeed the upper wedge wall~$y = +x$ is a traced boundary of the upper branch,
while the lower wedge wall~$y = -x$ is one of the lower branch.

More interesting of course are the new boundaries obtained;
by construction, these also are curves
along which the boundary condition~(\ref{eq:scaled-contact-linearised}) holds.
More complicated boundaries can be constructed
by patching these curves together in almost arbitrary fashion
(Figure~X); % TODO
the only restriction is that the boundary normal
have consistent orientation.
Since the flux in~(\ref{eq:scaled-contact-linearised}) is positive,
$U$~must be greater on the exterior,
and given the strictly negative $x$-derivative~%
  (\ref{eq:helmholtz-gradient-x-component}),
we may ensure consistent boundary orientation
by always identifying the region to the left as exterior.
Thus, each patching together of boundaries
will mark out a new domain to the right,
which also admits the solution~(\ref{eq:scaled-helmholtz-solution})
to the Helmholtz BVP~(\ref{eq:scaled-helmholtz})
\&~(\ref{eq:scaled-contact-linearised}).

\subsection{Corner rounding}
\label{sec:moderate.linearised.rounding}

While the domains produced in Figure~X
are most interesting,
their boundaries contain sharp corners,
incompatible with our goal of constructing a rounded corner.
Recall that at any point \emph{strictly} within the viable domain,
two traced boundaries will cross at a non-zero angle,
forming a sharp corner if they are patched together.
To avoid corners we must therefore only perform patching
along the terminal curve, i.e.~at a terminal point.
Moreover, patching must only be performed at a critical terminal point,
for at an ordinary terminal point,
the two local traced boundaries form a cusp with inconsistent boundary normal
(see Section~\ref{sec:introduction.tracing}).
From Figure~X
we see that there is only one critical terminal point,
located at the intersection between
the terminal curve~(\ref{eq:helmholtz-terminal-curve})
and the line of symmetry~$y = 0$,
\begin{equation}
  (x_0, y_0) = \roundbr*{\frac{\log 2}{\sqrt{2}}, \, 0}.
  \label{eq:helmholtz-critical-terminal-point}
\end{equation}
The local $U$-contour lies on the viable side of the terminal curve;
therefore the critical terminal point is of hyperbolic type,
and two smooth traced boundaries pass through it
(Figure~X). % TODO
The portions to the left of the critical terminal point
eventually collide (at a non-zero angle) with the wedge walls,
so they do not form an acceptable rounding of the corner.
However, the portions to the right
can be shown to asymptotically approach the wedge walls;
patching them together gives the unique corner rounding
for this problem (Figure~X). % TODO
We have therefore constructed a rounded-corner domain
which also admits the known solution~(\ref{eq:scaled-helmholtz-solution})
to the BVP~(\ref{eq:scaled-helmholtz})
\&~(\ref{eq:scaled-contact-linearised}).
To assess the effect that such a corner rounding will have
on the height rise,
we simply evaluate the known solution
along the walls of the original sharp-cornered wedge
and along the rounded corner;
the resulting height rise profiles are shown in
Figure~X. % TODO

Of course the discovery of a single rounded corner
hardly completes an analysis of corner rounding.
Anderson~\etal~\cite{anderson-2007-boundary-tracing-ii-applications}
produced different roundings of the corner
by adding Bessel functions
to the known solution~(\ref{eq:scaled-helmholtz-solution})
before applying boundary tracing.
We note that such a superpositioning technique depends on
the linearity of the Helmholtz equation~(\ref{eq:scaled-helmholtz});
in the case of the Laplace--Young equation, which is nonlinear,
a different method is needed to produce multiple roundings of a corner.

\section{Nonlinear corner rounding}
\label{sec:moderate.nonlinear}

Having seen linearised corner rounding
for wedge half-angle~$\alpha = \pi/4$
and contact angle~$\gamma \approx \pi/2$,
we now consider the fully nonlinear Laplace--Young equation
over the moderate-wedge interval~$\pi/2 - \gamma \le \alpha < \pi/2$,
corresponding to convex capillary wedges whose corner height is bounded.
Since there are no exact solutions to work with,
the process consists of two parts:
first computing a numerical solution
to the BVP~(\ref{eq:scaled-laplace-young})
\&~(\ref{eq:scaled-contact-boundary-condition})
in a sharp-cornered wedge,
then applying boundary tracing to seek a rounded corner.

While corner rounding using a numerical wedge solution
was presented in Section~3.5
of the author's Honours thesis~\cite{li-2017-thesis-rounding-capillary-wedge}
(with some related theoretical discussion in Section~3.3),
we note a difference in objective with the work here.
In~\cite{li-2017-thesis-rounding-capillary-wedge},
the method was merely used
to assess the accuracy of asymptotic corner roundings
(obtained by applying corner rounding to asymptotic solutions);
here, corner rounding with a numerical solution
is performed for its own sake.

\subsection{Numerical BVP solver}
\label{sec:moderate.nonlinear.numerical}

Numerical wedge solutions are computed
via finite elements in \software{Mathematica}.
The capillary BVP~(\ref{eq:scaled-laplace-young})
\&~(\ref{eq:scaled-contact-boundary-condition})
may be viewed as the steady-state diffusion problem
\begin{align}
  \del \dotp \squarebr[\bulkysize]{K (\del T) \del T} &= T,
    \label{eq:laplace-young-diffusion}
    \\[\tallspace]
  \normalvec \dotp \squarebr[\bulkysize]{K (\del T) \del T} &= \cos\gamma,
  \label{eq:contact-boundary-condition-diffusion}
\end{align}
with interior sink~$T$, boundary supply~$\cos\gamma$,
and nonlinear diffusion coefficient
\begin{equation}
  K (\del T) = \frac{1}{\sqrt{1 + (\del T)^2}}.
  \label{eq:laplace-young-diffusion-coefficient}
\end{equation}
\software{Mathematica~12}'s \code{NDSolve\`{}FEM\`{}} package
has built-in support for nonlinear BVPs,
and in the case of~(\ref{eq:laplace-young-diffusion})
\&~(\ref{eq:contact-boundary-condition-diffusion}),
the nonlinearity can be handled
by simply setting the \code{"DiffusionCoefficients"} property
to~$-K (\del T) \idenmat[2]$,
where $\idenmat[2]$~is the $2 \times 2$ identity matrix.%
\footnote{
  In~\cite{li-2017-thesis-rounding-capillary-wedge},
  an older version of \software{Mathematica} was used
  which could only solve linear BVPs.
  The nonlinearity was instead handled
  by a simple (but very slow) fixed-point iteration,
  which linearised~(\ref{eq:laplace-young-diffusion})
  \&~(\ref{eq:contact-boundary-condition-diffusion})
  by using $K (\del T)$~evaluated from the previous step.
}

\subsubsection{Half-plane benchmarking}
\label{sec:moderate.nonlinear.numerical.half-plane}

Before computing wedge solutions,
we benchmark the numerical solver
against the known solution
for liquid against a single wall
(Figure~X). % TODO
In this problem,
the Laplace--Young equation~(\ref{eq:scaled-laplace-young})
is to be satisfied in the region~$x > 0$ occupied by the liquid,
while the contact condition~(\ref{eq:scaled-contact-boundary-condition})
is to be satisifed along the wall~$x = 0$.
The known solution,
called the \term{half-plane solution}~%
  \cite{anderson-2006-exact-solutions-laplace-young},
takes on the implicit form
\begin{equation}
  x (T) \ideq
    \cosh^{-1} \roundbr*{\frac{2}{T}} - \sqrt{4 - T^2}
    - \cosh^{-1} \roundbr*{\frac{2}{h}} + \sqrt{4 - h^2},
  \label{eq:half-plane-solution}
\end{equation}
where
\begin{equation}
  h = \sqrt{2 (1 - \sin\gamma)}
  \label{eq:half-plane-height}
\end{equation}
is the height rise at the wall~$x = 0$.

Following Scott~\etal~\cite{scott-2005-computation-capillary-laplace-young},
we test our numerical solver in a $10 \times 1$~rectangle,
namely $0 < x < 10$, $-1/2 < y < 1/2$.
The contact condition~(\ref{eq:contact-boundary-condition-diffusion})
is applied along the wall-edge~$x = 0$,
while the natural Neumann condition
\begin{equation}
  \normalvec \dotp \squarebr[\bulkysize]{K (\del T) \del T} = 0
  \label{eq:natural-boundary-condition-diffusion}
\end{equation}
(corresponding to a non-wetting contact angle of~$\pi/2$)
is applied on the other three edges
so that the resulting numerical solution will both be $y$-independent
and vanish at infinity (approximated by~$x = 10$).

The rectangle is to be discretised into an unstructured triangular mesh,
and we use this opportunity to determine
a suitable level of mesh refinement to use
near the wall~$x = 0$, where the nonlinearity is significant.
Rather than specify an explicit refinement
(e.g.~a maximum cell area which increases with distance from the wall),
we use a minimalistic refinement strategy with only one rule:
the mesh vertices along~$x = 0$ must be spaced apart
by no more than~$\ell$, a chosen fine length scale.
Away from~$x = 0$ we simply let \software{Mathematica}'s
default meshing algorithm do its job,
resulting in a finite element mesh
that changes rapidly from fine to coarse
as one moves away from~$x = 0$
(Figure~X). % TODO

\begin{table}
  \centering
  \begin{tabular}{
    S[table-format=1.3]
    S[table-format=4]
    S[table-format=1.4, round-mode=places, round-precision=4]
    S[table-format=+1.1e+1, round-mode=figures, scientific-notation=true]
  }
    \toprule
      {$\ell$}  &
      {\makecell{Mesh \\ elements}}  &
      {\makecell{Computed \\ height}}  &
      {\makecell{Relative \\ error}} \\
    \midrule
      0.001  &  6365  &  1.39754  &  -0.00304964 \\
      0.002  &  3459  &  1.39448  &  -0.00523459 \\
      0.005  &  1769  &  1.38838  &  -0.00958739 \\
      0.01   &  1190  &  1.38119  &  -0.0147169  \\
      0.02   &   899  &  1.36942  &  -0.023112   \\
      0.05   &   713  &  1.34613  &  -0.0397284  \\
      0.1    &   675  &  1.3332   &  -0.0489483  \\
      0.2    &   629  &  1.32062  &  -0.0579258  \\
    \bottomrule
  \end{tabular}
  \caption{
    Numerical results for half-plane wall height
    for~$\gamma = \SI{1}{\degree}$,
    for various refinement length scales~$\ell$.
  }
  \label{tab:half-plane-height-refinement-length}
\end{table}

Smaller contact angles are more computationally demanding
(as the slope near the wall is greater),
so we use~$\gamma = \SI{1}{\degree}$ for our benchmarking test.
For each chosen value of fine length scale~$\ell$,
a numerical solution is computed in the corresponding mesh,
with a computed wall height then obtained
by evaluating at~$(x, y) = (0, 0)$.
Table~\ref{tab:half-plane-height-refinement-length}
compares the computed heights
with the theoretical height~(\ref{eq:half-plane-height})
(which for~$\gamma = \SI{1}{\degree}$ evaluates to~$h = 1.4018$);
to obtain an error of less than~$\SI{1}{\percent}$
it suffices to use~$\ell = 0.005$.
For this choice of fine length scale,
our mesh consists of only 1769~elements.
This is a full order of magnitude lower than
Scott~\etal~\cite{scott-2005-computation-capillary-laplace-young}'s
mesh of 18000~elements, refined adaptively
with a mesh-element density proportional to the solution slope,
but which nevertheless only achieves an error of~$\SI{1.7}{\percent}$
in the computed wall height.
Clearly our minimalistic refinement strategy
offers a much more economical discretisation
by using a finer but much more localised refinement.
Figure~X % TODO
shows that the relative error
\begin{equation}
  \abs*{\frac{\textq{computed~$T$}}{\textq{exact~$T$}} - 1}
  \label{eq:half-plane-relative-error}
\end{equation}
for our numerical solution already decreases very rapidly
with increasing~$x$;
further small-scale refinement away from the wall~$x = 0$
is both unnecessary and wasteful.

\subsubsection{Wedge solutions}
\label{sec:moderate.nonlinear.numerical.wedge}

We now proceed to compute numerical solutions
in a wedge with interior angle~$2 \alpha$.
To approximate an infinite wedge,
the domain is taken to be the sector
$0 < r < 10$, $-\alpha < \phi < \alpha$
in polar coordinates.
The contact condition~(\ref{eq:contact-boundary-condition-diffusion})
is only applied along the two wedge walls~$\phi = \pm \alpha$.
To approximate a vanishing height rise at infinity,
the non-wetting zero-flux condition~%
  (\ref{eq:natural-boundary-condition-diffusion})
is applied instead along the far arc~$r = 10$.

Again the domain is discretised into an unstructured triangular mesh.
Since the aim is to use the resulting numerical wedge solutions
for boundary tracing,
we need to be able to evaluate first derivatives accurately;
therefore we require all mesh elements to have no more area than
the equilateral triangle of side length~$0.2$.
The minimalistic refinement strategy
of Section~\ref{sec:moderate.nonlinear.numerical.half-plane}
is applied along the two wedge walls~$\phi = \pm \alpha$.%
\footnote{
  In~\cite{li-2017-thesis-rounding-capillary-wedge},
  the mesh refinement was a function of the distance~$r$ from the corner.
  In hindsight this was a very poor choice,
  as the nonlinearity is significant
  along the entire length of the wedge walls,
  not just near the corner.
}
Since these walls are of length~$10$
(much greater than the length~$1$
of the refined wall for the half-plane benchmarking test),
we choose a more frugal fine length scale~$\ell = 0.01$
to avoid an excessive number of mesh elements.
For an $\alpha = \SI{40}{\degree}$ wedge,
the resulting mesh contains around~17000 elements
(Figure~X).

\begin{table}
  \centering
  \begin{tabular}{
    S[table-format=2, table-space-text-post=\si{\degree}]
    S
    S[table-format=1.4e1]
    S[table-format=1.4, round-mode=places, round-precision=4]
    S[table-format=1.4e1]
    S[table-format=+1.1e+1, round-mode=figures, scientific-notation=true]
  }
    \toprule
      {$\gamma$}  &
      {\makecell{Theoretical \\ height}}  &
      {\makecell{Computed \\ height}}  &
      {\makecell{Theoretical \\ slope}}  &
      {\makecell{Computed \\ slope}}  &
      {\makecell{Relative \\ error}} \\
    \midrule
      30 \si{\degree}  &
        {$\infty$}  &  4.2413e2 &
        {$\infty$}  &  1.0691e5 &  {N/A} \\
      35 \si{\degree}  &
        {$\infty$}  &  3.3581e2 &
        {$\infty$}  &  8.4822e4 &  {N/A} \\
      40 \si{\degree}  &
        {$\infty$}  &  2.3533e2 &
        {$\infty$}  &  5.9586e4 &  {N/A} \\
      45 \si{\degree}  &
        {$\infty$}  &  1.0604e2 &
        {$\infty$}  &  2.6716e4 &  {N/A} \\
      50 \si{\degree}  &
        {finite}    &  2.0328   &
        {$\infty$}  &  1.6344e1 &  {N/A} \\
      55 \si{\degree}  &
        {finite}    &  1.5288  &
        1.97684     &  1.9758   &  -0.000509473 \\
      60 \si{\degree}  &
        {finite}    &  1.2548   &
        1.23778     &  1.2376   &  -0.000145694 \\
      65 \si{\degree}  &
        {finite}    &  1.0199   &
        0.872594    &  0.8726   &  -0.0000453895 \\
      70 \si{\degree}  &
        {finite}    &  0.8030   &
        0.628435    &  0.6284   &  -0.0000225007 \\
      75 \si{\degree}  &
        {finite}    &  0.5959   &
        0.439886    &  0.4399   &  -0.000012508 \\
      80 \si{\degree}  &
        {finite}    &  0.3946   &
        0.280581    &  0.2806   &  -7.90934e-6 \\
      85 \si{\degree}  &
        {finite}    &  0.1966   &
        0.136854    &  0.1369   &  -6.38643e-6 \\
    \bottomrule
  \end{tabular}
  \caption{
    Numerical results for corner height and corner slope
    in an $\alpha = \SI{40}{\degree}$ wedge,
    for various contact angles~$\gamma$.
  }
  \label{tab:convex-wedge-height-slope}
\end{table}

Numerical solutions may now be computed in the generated meshes
for various choices of wedge half-angle~$\alpha$ and contact angle~$\gamma$.
We recall that the height in the corner will be unbounded
if and only if~$\alpha < \pi/2 - \gamma$ (the small wedge regime),
and that the slope will be unbounded
if and only if~$\alpha \le \pi/2 - \gamma$.
Evidently infinite heights and slopes cannot be handled numerically,
but nevertheless if we apply our numerical solver in such cases,
we find that the singularities do manifest themselves
in the form of large quantities.
Table~\ref{tab:convex-wedge-height-slope}
shows the computed corner height and corner slope
in an $\alpha = \SI{40}{\degree}$ wedge;
indeed large heights and slopes are observed
as the contact angle~$\gamma$
decreases past the critical angle~$\pi/2 - \alpha = \SI{50}{\degree}$.
In the cases where the corner slope is finite,
the computed value is in good agreement with the theoretical value
(given by the coefficient of~$r \cos\phi$
in the asymptotic form~(\ref{eq:moderate-wedge-asymptotic-solution})),
and we can be confident that the numerical solution
accurately represents the true solution in an infinite wedge.

\subsection{Boundary tracing}
\label{sec:moderate.nonlinear.tracing}

Having obtained numerical solutions in sharp-cornered wedges,
we now proceed to the boundary tracing part
of the nonlinear corner rounding problem.
Here we consider the full interval of wedges with a bounded corner height,
$\pi/2 - \gamma \le \alpha < \pi/2$;
this includes the borderline case~$\alpha = \pi/2 - \gamma$,
which has an unbounded corner slope.
The small wedge case~$0 < \alpha < \pi/2 - \gamma$
(which has an unbounded corner height)
requires a separate numerical treatment,
and is deferred to Chapter~X. % TODO

New boundaries are sought
along which the constant-contact-angle condition~%
  (\ref{eq:scaled-contact-boundary-condition})
holds.
Rewriting this condition as
\begin{important}{equation}
  \normalvec \dotp \del T = \cos\gamma \sqrt{1 + (\del T)^2}
  \label{eq:scaled-contact-flux-boundary-condition}
\end{important}
and comparing it to the generic boundary condition~%
  (\ref{eq:flux-boundary-condition}),
it follows that the flux function is given by
\begin{equation}
  F \ideq \cos\gamma \sqrt{1 + (\del T)^2}.
  \label{eq:contact-flux-function}
\end{equation}
The viability function is therefore
\begin{align*}
  \Phi
  &\ideq (\del T)^2 - F^2 \\
  &\ideq \sin^2\gamma \, (\del T)^2 - \cos^2\gamma,
    \yesnumber
    \label{eq:contact-viability-function}
\end{align*}
and the viable domain can be written simply as
\begin{equation}
  \norm{\del T} \ge \cot\gamma.
  \label{eq:contact-viable-domain}
\end{equation}
As a physical statement,
this asserts that the sought-after traced boundaries
will only exist in the region
where the known solution~$T$ is sufficiently steep;
specifically, at least as steep as a surface
which meets a vertical wall with contact angle~$\gamma$.

While polar coordinates would be appropriate
for an analytical description of the wedge,
the numerical wedge solutions are Cartesian-based.
Staying in Cartesian coordinates,
the components of the gradient vector
are the derivatives
\begin{align}
  P &\ideq \pder{T}{x},
    \label{eq:moderate-gradient-x-component} \\[\tallspace]
  Q &\ideq \pder{T}{y}.
    \label{eq:moderate-gradient-y-component}
\end{align}

\section{Multiple roundings of a corner}
\label{sec:moderate.multiple}
