\chapter{Small wedges}
\label{ch:small}

In this chapter
we apply numerical boundary tracing to analyse corner rounding
in small capillary wedges,
for which the wedge half-angle~$\alpha$ and the contact angle~$\gamma$
satisfy the inequality~$\alpha < \pi/2 - \gamma$
and the height rise in the corner is infinite.

The author's Honours thesis~%
  \cite{li-2017-thesis-rounding-capillary-wedge}
considered an asymptotic version of boundary tracing
in which the leading term~(\ref{eq:small-wedge-asymptotic-solution})
was used as the known solution.
Although that analysis was able to produce
a corresponding asymptotic corner rounding,
one could not be certain that the rounding actually lay
within the region of validity
of the asymptotic known solution~(\ref{eq:small-wedge-asymptotic-solution}).
The accuracy of the asymptotic corner rounding
could only be assessed indirectly
by computing a numerical solution in the corresponding rounded-corner domain
(which no longer had a singularity)
and then comparing it
to the asymptotic solution~(\ref{eq:small-wedge-asymptotic-solution}).

It is more preferable to avoid the use of an asymptotic approximation,
so that the results of boundary tracing are applicable throughout the wedge,
rather than only in a near-corner region of unknown size.
Therefore, we determine here a numerical solution
to the scaled capillary BVP~(\ref{eq:scaled-laplace-young})
\&~(\ref{eq:scaled-contact-boundary-condition})
and apply boundary tracing to it,
instead of to an asymptotic solution.

\section{Numerical wedge solutions}
\label{sec:small.numerical}

While the numerical solver of Section~\ref{sec:moderate.nonlinear.numerical}
was able to generate solutions in the small wedge case,
their validity is questionable
given the $1/r$~singularity in the corner.

A better approach involves extracting the singularity
before performing numerical work.
Such an approach has been employed by
Aoki \&~De~Sterck~\cite{aoki-2014-numerical-study-unbounded-capillary}
to determine accurate numerical representations
of unbounded solutions to the capillary problem,
specifically in the case of a general domain with two boundary walls,
$y = f (x)$ and $y = g (x)$,
forming either a small wedge or a cusp at the origin.
In this scenario,
the solution to the capillary problem~(\ref{eq:scaled-laplace-young})
\&~(\ref{eq:scaled-contact-boundary-condition})
is unbounded at the origin,
the asymptotic height rise being~$T \asy 1 / (f - g)$.
Their method consists of two parts.
The first is the change of dependent variable
\begin{equation}
  T (x, y) \ideq \frac{H (x, y)}{f (x) - g(x)},
  \label{eq:capillary-unbounded-change-of-variable}
\end{equation}
which ensures that the new dependent variable~$H$ is bounded.
The second is the change of coordinates
\begin{align}
  x &\ideq X,
    \label{eq:capillary-unbounded-x-transformation} \\
  y &\ideq \frac{1 + Y}{2} f (X) + \frac{1 - Y}{2} g (X),
    \label{eq:capillary-unbounded-y-transformation}
\end{align}
which maps the original domain $x > 0$, $g (x) < y < f (x)$
to the rectangle $X > 0$, $-1 < Y < 1$.
In particular, this maps the origin~$(x, y) = (0, 0)$
to the line segment $X = 0$, $-1 < Y < 1$,
so that any discontinuity in~$H$ at the origin
(i.e.~a dependence on the direction of approach)
in the original coordinates~$(x, y)$
will not be exhibited in the new coordinates~$(X, Y)$.

The transformation~(\ref{eq:capillary-unbounded-x-transformation})
\&~(\ref{eq:capillary-unbounded-y-transformation})
is most general,
allowing the walls of the wedge or cusp to be curved.
Note that the new coordinates~$(X, Y)$ are not orthogonal.
In the present situation
we seek numerical solutions in wedge domains with straight walls,
namely domains of the form
$0 < r < 10$, $-\alpha < \phi < \alpha$
in polar coordinates.
Requiring not the generality of~(\ref{eq:capillary-unbounded-x-transformation})
\&~(\ref{eq:capillary-unbounded-y-transformation}),
but nevertheless inspired by the overall idea,
we implement here a similar transformation in polar coordinates
(which are orthogonal).

\subsection{Singularity extraction}
\label{sec:small.numerical.extraction}

After scaling out the capillary length~(\ref{eq:capillary-length})
as before,
the asymptotic height rise~(\ref{eq:small-wedge-asymptotic-solution})
in a small wedge reduces to
\begin{equation}
  T \asy \frac{\cos\phi - \sqrt{k^2 - \sin^2 \phi}}{k r},
  \label{eq:small-wedge-scaled-asymptotic-solution}
\end{equation}
where $k$~is given by~(\ref{eq:wedge-constant-k}), i.e.
\begin{equation}
  k = \frac{\sin\alpha}{\cos\gamma}.
  \label{eq:small-wedge-constant-k}
\end{equation}
In analogy to~(\ref{eq:capillary-unbounded-change-of-variable}),
we apply the transformation
\begin{equation}
  T (r, \phi) \ideq \frac{H (r, \phi)}{r}
  \label{eq:small-wedge-change-of-variable}
\end{equation}
so that the new dependent variable~$H$ is bounded and continuous
(in the sense of single-valuedness for~$-\alpha < \phi < \alpha$)
at~$r = 0$.

Now the numerical BVP solver of \software{Mathematica}
can only handle rectangular coordinates.
Coefficient matrices are always interpreted
as components of a rectangular coordinate system,
and if the list of independent variables supplied is~$(u, v)$,
the corresponding list of derivative operators
will be~$(\pd / {\pd u}, \pd / {\pd v})$,
which does not accord with
the physical gradient and divergence operators
unless the scale factors are unity.
Indeed the polar coordinate system is not rectangular,
so we must first rewrite the capillary problem~(\ref{eq:scaled-laplace-young})
\&~(\ref{eq:scaled-contact-boundary-condition})
in terms of~$(\pd / {\pd r}, \pd / {\pd\phi})$,
so that that $r$ and~$\phi$ may be interpreted formally
as rectangular coordinates.

After effecting the transformation~(\ref{eq:small-wedge-change-of-variable})
(see Appendix~\ref{ch:extraction}),
the capillary problem~(\ref{eq:scaled-laplace-young})
\&~(\ref{eq:scaled-contact-boundary-condition}) in~$T$
becomes the BVP
\begin{align}
  \matder \dotp \squarebr[\bulkysize]{\mat{K} \matder H - \mat{v} H}
    &= H,
    \label{eq:small-formally-rectangular-laplace-young} \\
  \mat{n} \dotp \squarebr[\bulkysize]{\mat{K} \matder H - \mat{v} H}
    &= \cos\gamma
    \label{eq:small-formally-rectangular-contact-boundary-condition}
\end{align}
in~$H$, where
\begin{align}
  \matder &\ideq
    \begin{pmatrix}
      \pd / {\pd r} \\
      \pd / {\pd\phi}
    \end{pmatrix},
    \label{eq:small-formally-rectangular-derivative} \\
  \mat{K} &\ideq
    \begin{pmatrix}
      r^2 C & 0 \\
      0 & C
    \end{pmatrix},
    \label{eq:small-formally-rectangular-diffusion-coefficient} \\
  \mat{v} &\ideq
    \begin{pmatrix}
      r C \\
      0
    \end{pmatrix},
    \label{eq:small-formally-rectangular-convection-coefficient}
\end{align}
and $\mat{n}$~is to~$\matder$ as $\normalvec$~is to~$\del$,
with
\begin{equation}
  C \ideq \frac{1}{\sqrt{r^4 + \tilde{P}^2 + \tilde{Q}^2}},
  \label{eq:small-formally-rectangular-scalar-coefficient}
\end{equation}
where
\begin{align}
  \tilde{P} &\ideq r \pder{H}{r} - H,
    \\[\tallspace]
  \tilde{Q} &\ideq \pder{H}{\phi}.
\end{align}
The transformed problem~(\ref{eq:small-formally-rectangular-laplace-young})
\&~(\ref{eq:small-formally-rectangular-contact-boundary-condition})
is to be solved in the region
$0 < r < 10$, $-\alpha < \phi < \alpha$,
which algebraically has the form of a rectangle
(Figure~\ref{fig:wedge_small-domain-formal-rectangle}).
Note that $\mat{n}$~is not a physical normal vector,
and that $\matder$~is not a physical vector operator.
Only $\normalvec$ and~$\del$ have a physically meaningful interpretation
in association with the original wedge
(Figure~\ref{fig:wedge_small-domain-original-wedge}).
While it is useful to think of~$\mat{n}$ and~$\matder$
as analogous entities for the rectangle of
Figure~\ref{fig:wedge_small-domain-formal-rectangle},
they are merely an algebraic means to the end of computing~$H$
using a numerical solver that assumes a rectangular coordinate system.

\begin{figure}
  \newcommand*{\subfigurewidth}{0.3\textwidth}
  \centering
  \hspace*{\fill}
  \begin{subfigure}[t]{\subfigurewidth}
    \centredfigurecontent{wedge_small-domain-original-wedge}{%
      Original wedge
    }
  \end{subfigure}
    \hfill
  \begin{minipage}[t]{0.25\textwidth}
    \centering
    \includegraphics[width=\textwidth, trim=0 {-0.35\textwidth} 0 0]{%
      wedge_small-domain-double-arrow%
    }
  \end{minipage}
    \hfill
  \begin{subfigure}[t]{\subfigurewidth}
    \centredfigurecontent{wedge_small-domain-formal-rectangle}{%
      Formal rectangle
    }
  \end{subfigure}
  \hspace*{\fill}
  \caption{
    Alternative interpretations of the domain
    $0 < r < 10$, $-\alpha < \phi < \alpha$.
  }
  \label{fig:wedge_small-domain}
\end{figure}

\subsection{Implementation}
\label{sec:small.numerical.implementation}

The rectangle of Figure~\ref{fig:wedge_small-domain-formal-rectangle}
is discretised into an unstructured triangular mesh.
The minimalistic refinement strategy
of Section~\ref{sec:moderate.nonlinear.numerical.half-plane}
is applied
along~$r = 0$ (which represents the wedge corner)
and~$\phi = \pm\alpha$ (which represent the wedge walls)
using a fine length scale of~$0.01$.
To ensure that first derivatives
can also be computed accurately elsewhere
for the purposes of boundary tracing,
a coarser uniform refinement is also applied throughout the mesh,
such that no mesh element has more area than the equilateral triangle
whose side length is the lesser of~$0.1$ and~$\alpha / 5$.
An example mesh is shown in
Figure~\ref{fig:wedge_small-mesh-detail}.

\begin{figure}
  \centredfigurecontent[width=0.8\textwidth]{%
    wedge_small-mesh-detail%
  }{
    Portion of the finite element mesh
    for an $\alpha = \SI{30}{\degree}$~formal rectangle.
  }
\end{figure}

While the PDE~(\ref{eq:small-formally-rectangular-laplace-young})
is applied throughout the rectangular region,
the boundary condition~%
  (\ref{eq:small-formally-rectangular-contact-boundary-condition})
as written
is only used along the boundaries~$\phi = \pm\alpha$
representing the wedge walls.
Along the boundary~$r = 10$ we instead use the non-wetting version
\begin{equation}
  \mat{n} \dotp \squarebr[\bulkysize]{\mat{K} \matder H - \mat{v} H} = 0
  \label{eq:small-formally-rectangular-natural-boundary-condition}
\end{equation}
(equivalent to setting~$\gamma = \pi/2$)
to model a vanishing height rise at infinity.
It remains to specify the boundary condition along the boundary~$r = 0$,
which represents the corner of the original wedge.
Defining the angular function
\begin{equation}
  H_0 \ideq \frac{\cos\phi - \sqrt{k^2 - \sin^2 \phi}}{k},
  \label{eq:small-asymptotic-angular-function}
\end{equation}
the asymptotic relation~(\ref{eq:small-wedge-scaled-asymptotic-solution})
for small~$r$ becomes
\begin{equation}
  T \asy \frac{H_0}{r},
  \label{eq:small-asymptotic-solution}
\end{equation}
and we see that a suitable boundary condition to apply along~$r = 0$
is the Dirichlet condition
\begin{equation}
  H = H_0.
  \label{eq:small-formally-rectangular-dirichlet-condition}
\end{equation}

Although \software{Mathematica~12}'s built-in numerical solver
can handle nonlinear problems using Newton's method,
convergence issues arise for the BVP at hand.
We therefore implement a custom fixed-point iteration instead,
at each step supplying a linearised BVP
by pre-evaluting the coefficients~$\mat{K}$ and~$\mat{v}$
using the solution computed from the previous step.
For the initial guess we use
the asymptotic angular function~(\ref{eq:small-asymptotic-angular-function}).
While fixed-point iteration is slower than Newton's method,
it is very robust, and we do not encounter any problems with convergence.
Selected results are shown in Figure~\ref{fig:wedge_small-solution}.

\begin{figure}
  \newcommand*{\subfigurewidth}{0.45\textwidth}
  \centering
  \begin{subfigure}[t]{\subfigurewidth}
    \centredfigurecontent{%
      wedge_small-solution-small%
    }{%
      $\gamma = \SI{45}{\degree}$ (small regime)
    }
  \end{subfigure}
    \hfill
  \begin{subfigure}[t]{\subfigurewidth}
    \centredfigurecontent{%
      wedge_small-solution-borderline%
    }{%
      $\gamma = \SI{60}{\degree}$ (borderline case)
    }
  \end{subfigure}
  \caption{
    Radial profiles (for both~$H$ and~$T$) of selected numerical solutions
    in an $\alpha = \SI{30}{\degree}$~wedge.
    Curves from bottom to top:
    $\phi =
      \SI{0}{\degree}, \SI{10}{\degree},
      \SI{20}{\degree}, \SI{30}{\degree}$.
  }
  \label{fig:wedge_small-solution}
\end{figure}

It is interesting to note that
the numerical scheme is able to produce a sensible result
for the borderline case~$\alpha = \pi/2 - \gamma$,
where the height rise in the corner should be finite.
While the transformation~(\ref{eq:small-wedge-change-of-variable})
appears at first glance to preclude a bounded solution in~$T$,
the borderline case has~$k = 1$,
and hence an identically vanishing
asymptotic angular function~(\ref{eq:small-asymptotic-angular-function}).
The Dirichlet condition~%
  (\ref{eq:small-formally-rectangular-dirichlet-condition})
therefore reduces to~$H = 0$,
and the singularity at~$r = 0$ is eliminated.
While it is possible to estimate the height rise~$T$ in the corner
by extrapolating the computed value of~$H / r$ to~$r = 0$,
we should not expect a high level of accuracy
due to (multiplicative) catastrophic cancellation
between~$H$ (going to zero) and~$1 / r$ (going to infinity).
We may compare $T \ideq H / r$~obtained here using
the polar-coordinate transformation~(\ref{eq:small-wedge-change-of-variable})
with the corresponding numerical solution
obtained in Section~\ref{sec:moderate.nonlinear.numerical.wedge}
by directly using the Cartesian-based BVP solver.
Figure~\ref{fig:wedge_small-borderline-comparison}
shows the relative discrepancy
\begin{equation}
  \abs*{\frac{\textq{polar~$T$}}{\textq{Cartesian~$T$}} - 1}
  \label{eq:wedge_small-relative-discrepancy-with-cartesian}
\end{equation}
between the two approaches
for the specific example of~$\alpha = \SI{30}{\degree}$.
As expected,
the discrepancy of~$\SI{10}{\percent}$ at~$r = 0$
is not exceedingly small,
but as we move away from the corner,
the discrepancy decreases very quickly.
The fact that two very different approaches
produce numerical solutions in close agreement
allows us to be confident in the results of both.

\begin{figure}
  \centredfigurecontent[width=!, height=0.35\textwidth]{%
    wedge_small-borderline-comparison%
  }{
    Relative discrepancy~%
      (\ref{eq:wedge_small-relative-discrepancy-with-cartesian})
    between polar- and Cartesian-based numerical solutions,
    for the borderline case~%
    $(\alpha, \gamma) = (\SI{30}{\degree}, \SI{60}{\degree})$.
  }
\end{figure}
