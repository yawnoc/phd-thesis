\chapter{Boundary tracing in the complex plane}
\label{ch:complex}

When the known solution~$T$ satisfies Laplace's equation,
it is possible to recast the traced boundaries
as solutions to an ODE in the complex variable~$z = x + \ii y$.

From the boundary tracing system~%
  (\ref{eq:tracing-ode-arc-length-parametrisation-u})
\&~%
  (\ref{eq:tracing-ode-arc-length-parametrisation-v})
for arc-length parametrisation,
we have
\begin{equation}
  \tder{z}{s}
    = \tder{(x + \ii y)}{s}
    = \frac{(-Q + \ii P) F \pm (P + \ii Q) \sqrt{\Phi}}{(\del T)^2}.
  \label{eq:complex-tracing-ode-arc-length-parametrisation-z-raw}
\end{equation}
Complex function theory tells us that
$T$~is the real part of some analytic function,
i.e.
\begin{equation}
  W (z) = T (x, y) + \ii V (x, y),
  \label{eq:complex-analytic-function-components}
\end{equation}
whence
\begin{align}
  -Q + \ii P
    &= -\pder{T}{y} + \ii \pder{T}{x}
    = \ii \conj{\roundbr*{\tder{W}{z}}},
      \label{eq:complex-tracing-ode-flux-factor}
      \\[\tallspace]
  P + \ii Q
    &= +\pder{T}{x} + \ii \pder{T}{y}
    = \conj{\roundbr*{\tder{W}{z}}},
      \label{eq:complex-tracing-ode-viability-factor}
\end{align}
and
\begin{equation}
  (\del T)^2
    = \abs*{\tder{W}{z}}^2
    = \roundbr*{\tder{W}{z}} \conj{\roundbr*{\tder{W}{z}}}.
  \label{eq:complex-tracing-gradient-squared}
\end{equation}
Substituting these
into~(\ref{eq:complex-tracing-ode-arc-length-parametrisation-z-raw}),
we obtain the highly terse
\begin{important}{equation}
  \tder{z}{s} = \frac{\ii F \pm \sqrt{\Phi}}{\td W / {\td z}}
  \label{eq:complex-tracing-ode-arc-length-parametrisation-z}
\end{important}
for traced boundaries in the complex plane.

It is interesting to note that
if~$z = z (\zeta)$ according to some conformal mapping,
then we have
\begin{equation}
  \tder{\zeta}{s} = \frac{\ii F \pm \sqrt{\Phi}}{\td W / {\td\zeta}}
  \label{eq:complex-tracing-ode-arc-length-parametrisation-zeta}
\end{equation}
by the chain rule.
Since conformal mappings preserve harmonicity,
we may therefore determine traced boundaries as follows:
\begin{enumerate}
  \tightlist
  \item
    Choose a conformal mapping~$z = z (\zeta)$.
  \item
    Choose an analytic function~$W = W (\zeta)$.
  \item
    Write~$F$ and~$\Phi = (\del T)^2 - F^2$ in terms of~$\zeta$.
  \item
    Compute traced boundaries in $\zeta$-space
    using~(\ref{eq:complex-tracing-ode-arc-length-parametrisation-zeta}).
  \item
    Map the resulting curves back to $z$-space.
\end{enumerate}

\section{Example}
\label{sec:complex.example}

Consider a simple conduction problem,
where heat is lost to the environment
by convection along some external boundary
and supplied along an internal triangular boundary
held at constant temperature.
Suppose after scaling that these are represented
by the flux condition
\begin{equation}
  \normalvec \dotp \del T = -T / A
  \label{eq:example-flux-boundary-condition}
\end{equation}
and the Dirichlet condition
\begin{equation}
  T = B
  \label{eq:example-dirichlet-condition}
\end{equation}
respectively,
where~$A = 1.5$, $B = 1.6$,
and the vertices of the triangular boundary
are the three cubic roots of unity.

We choose the Schwarz--Christoffel transformation~$z = z (\zeta)$
given by
\begin{equation}
  \tder{z}{\zeta} = \frac{C}{\zeta^2} \roundbr*{1 - \zeta^3}^{2/3},
  \label{eq:conformal_triangle-mapping-derivative}
\end{equation}
which maps the interior of the unit disk in~$\zeta$-space
to the exterior of an equilateral triangle in~$z$-space
(Figure~X\@). % TODO
Integration yields
\begin{equation}
  z (\zeta) =
    -\frac{C}{\zeta}
    \hypergeo \roundbr*{-\tfrac{2}{3}, -\tfrac{1}{3}; \tfrac{2}{3}, \zeta^3},
  \label{eq:conformal_triangle-mapping}
\end{equation}
and we choose
\begin{equation}
  C =
    \frac{
      -1
    }{
      \hypergeo \roundbr*{-\tfrac{2}{3}, -\tfrac{1}{3}; \tfrac{2}{3}, 1}
    }
    = -0.730499
  \label{eq:conformal_triangle-mapping-constant}
\end{equation}
to ensure that $\zeta = 1$~is mapped to~$z = 1$.
Writing~$(\rho, \varphi)$ for polar coordinates in~$\zeta$-space
(so that~$\zeta = \rho \ee^{\ii \varphi}$),
we see that the unit circle~$\abs{\zeta} = \rho = 1$
is mapped to the desired triangular boundary in~$z$-space.
Selecting the analytic function
\begin{equation}
  W (\zeta) = \log \roundbr*{\frac{\zeta}{\rho_0}}
  \label{eq:conformal_triangle-analytic-function}
\end{equation}
where
\begin{equation}
  \rho_0 = \exp (-B) = 0.201897,
  \label{eq:conformal_triangle-minimum-zeta-radius}
\end{equation}
we obtain
\begin{equation}
  T = \re [W] = \log \roundbr*{\frac{\rho}{\rho_0}},
  \label{eq:conformal_triangle-known-solution}
\end{equation}
an harmonic function that satisfies
the Dirichlet condition~(\ref{eq:example-dirichlet-condition})
along the triangular boundary in~$z$-space
(Figure~X\@). % TODO
Note that the $T$-contours coincide
with the curves of constant~$\rho$.
